---
name: cli-alibabacloud-devops
description: CCPM系统扩展以支持阿里云云效平台，通过MCP协议实现multi-AI CLI架构和平台选择灵活性
status: backlog
created: 2025-09-29T07:03:54Z
---

# PRD: cli-alibabacloud-devops

## Executive Summary

本PRD定义了采用**最小改动原则**扩展CCPM系统以支持阿里云云效平台的功能需求。为避免与上游开源项目的重构冲突，采用**并行文件结构**方案：保持所有现有GitHub脚本完全不变，新增云效专用脚本文件，通过简单的配置检测路由机制实现平台选择。这样可以在提供云效支持的同时，确保上游更新时的冲突最小化。

## Problem Statement

### 当前问题
1. **平台局限性**：CCPM系统当前仅支持GitHub平台，限制了在使用阿里云云效的团队中的应用
2. **生态系统割裂**：国内许多企业使用阿里云云效进行项目管理和代码托管，无法享受CCPM的规范驱动开发和并行AI代理执行优势
3. **工作流不一致**：使用云效的团队需要采用不同的工作流程，无法利用CCPM的成熟方法论
4. **集成复杂性**：云效使用工作项（workitem）而非GitHub的issue，且项目与代码仓库的关联方式不同

### 为什么现在重要
- 阿里云云效在国内企业中使用广泛，市场需求强烈
- MCP协议的成熟为技术实现提供了标准化基础
- 上游项目正在重构multi-CLI架构，需要避免冲突
- 采用并行文件结构可以最小化未来合并难度
- 多平台支持将显著扩大CCPM的适用范围和用户基础

## User Stories

### 主要用户角色

#### 1. 开发者（Developer）
**背景**：使用阿里云云效进行日常开发工作的软件工程师
**需求**：希望在云效平台上享受CCPM的规范驱动开发体验

**用户故事**：
- 作为开发者，我希望能够在云效平台上使用CCPM的"/pm:*"命令，以便保持一致的开发工作流
- 作为开发者，我希望能够通过简单配置选择使用云效或GitHub平台，以便在不同项目中灵活切换
- 作为开发者，我希望云效平台上的工作项能够像GitHub issues一样被自动管理，以便享受并行AI执行的优势

#### 2. 项目经理（Project Manager）
**背景**：负责协调开发团队，管理项目进度和质量
**需求**：在云效平台上获得完整的项目可视性和控制能力

**用户故事**：
- 作为项目经理，我希望能够在云效平台上创建和管理PRD，以便维持规范驱动的开发流程
- 作为项目经理，我希望能够跟踪从PRD到工作项到代码的完整链路，以便确保需求可追溯性
- 作为项目经理，我希望能够在云效项目中查看Epic和Task的层次结构，以便更好地组织和管理工作

#### 3. 技术负责人（Tech Lead）
**背景**：负责技术架构决策和团队技术方向
**需求**：确保技术实现的质量和可维护性

**用户故事**：
- 作为技术负责人，我希望能够通过简单配置选择项目的平台（GitHub vs 云效），以便根据企业策略灵活部署
- 作为技术负责人，我希望云效集成能够保持CCPM的架构模式，以便维持系统的一致性和可维护性
- 作为技术负责人，我希望能够轻松配置云效项目ID，以便正确关联代码仓库和项目管理

### 接受标准

每个用户故事都需要满足：
- 功能在云效平台上的表现与GitHub平台保持一致
- 平台切换对用户透明，无需学习新的命令或工作流
- 所有CCPM核心功能（PRD、Epic、Task、并行执行）在云效平台上完全可用
- 配置过程简单直观，仅需要平台选择和project_id（云效）

## Requirements

### Functional Requirements

#### 1. 最小改动原则实现
- **FR-001**：采用并行文件结构，原GitHub脚本完全不修改
- **FR-002**：新增云效专用脚本文件（*-yunxiao.sh, *-yunxiao/目录）
- **FR-003**：通过简单路由机制根据配置选择对应脚本

#### 2. 云效并行实现
- **FR-004**：新增init-yunxiao.sh进行云效环境检测
- **FR-005**：新增epic-sync-yunxiao/目录，包含云效工作项管理脚本
- **FR-006**：新增issue-sync-yunxiao/目录，对应原有GitHub issue操作
- **FR-007**：创建fetch-yunxiao-workitems.sh等对应脚本文件

#### 3. 命令路由兼容
- **FR-008**：通过配置检测机制，命令自动路由到对应平台脚本
- **FR-009**：云效脚本实现与GitHub脚本相同的输入输出接口
- **FR-010**：保持Epic和Task文件结构不变，仅同步目标平台不同
- **FR-011**：云效脚本支持相同的并行AI执行模式

#### 4. 简化配置管理
- **FR-012**：项目配置仅需要：平台类型（github/yunxiao）+ project_id（仅云效需要）
- **FR-013**：云效认证通过MCP协议处理

## Success Criteria

### 主要成功指标

#### 1. 功能完整性
- **SC-001**：100% CCPM核心命令在云效平台可用
- **SC-002**：PRD→Epic→Task→WorkItem完整工作流正常运行
- **SC-003**：并行AI执行在云效平台达到与GitHub相同的效率

#### 2. 用户体验
- **SC-004**：用户能够在5分钟内完成平台配置
- **SC-005**：平台切换对用户命令使用方式无影响
- **SC-006**：95%的用户反馈满意度

### 可衡量结果
- 云效命令成功率：目标>98%
- 用户采用率：6个月内10+活跃云效项目
- 社区反馈：GitHub讨论区正面反馈>90%

## Constraints & Assumptions

### 技术约束
1. **最小改动限制**：不能修改任何现有GitHub相关脚本文件
2. **依赖MCP协议**：必须通过阿里云提供的MCP服务器进行集成
3. **云效API限制**：受阿里云云效API能力和限流策略约束
4. **文件命名约束**：云效相关文件必须使用-yunxiao后缀避免冲突

### 业务约束
1. **上游兼容性**：必须避免与上游项目的multi-CLI重构冲突
2. **GitHub零影响**：现有GitHub工作流必须完全不受影响
3. **配置简化**：仅支持最基础的平台配置和project_id

### 资源约束
1. **开发时间**：预计4-6周开发周期（并行开发模式）
2. **测试环境**：需要阿里云云效测试环境访问
3. **专业知识**：需要云效平台和MCP协议专业知识
4. **文件结构约束**：必须保持与现有GitHub脚本的文件结构一致性

### 假设条件
1. **MCP稳定性**：假设阿里云MCP服务器功能稳定可靠
2. **API完整性**：假设云效API能够满足所有必需的操作
3. **用户接受度**：假设用户愿意配置和使用云效集成

## Out of Scope

### 明确不包含的功能
1. **原有代码修改**：不修改任何现有GitHub相关脚本文件
2. **平台抽象层**：不创建复杂的平台抽象架构
3. **多平台同步**：不实现GitHub和云效之间的数据同步
4. **历史数据迁移**：不提供现有项目的历史数据迁移功能
5. **复杂配置管理**：仅支持平台选择和project_id两个配置项
6. **云效平台功能开发**：不开发云效平台本身的功能

## Dependencies

### 外部依赖

#### 1. 阿里云云效平台
- **云效MCP服务器**：https://github.com/aliyun/alibabacloud-devops-mcp-server
- **云效API稳定性**：依赖云效平台API的可用性和稳定性
- **MCP协议支持**：依赖MCP协议的持续支持和维护

#### 2. 技术栈依赖
- **Node.js**：运行环境，版本16+
- **Claude Code**：AI代理执行环境
- **Git**：版本控制系统
- **网络连接**：稳定的互联网连接访问云效服务

#### 3. 配置和权限
- **MCP认证**：通过MCP协议处理云效认证
- **项目权限**：用户需要在云效项目中具有相应的操作权限

### 内部依赖

#### 1. CCPM核心系统
- **现有命令架构**：依赖当前CCPM的命令系统架构
- **Agent框架**：依赖现有的AI代理协调机制
- **上下文系统**：依赖CCPM的上下文管理功能

#### 2. 开发资源
- **云效环境访问**：需要测试用的云效项目和权限
- **MCP专业知识**：需要团队成员具备MCP协议知识
- **云效平台理解**：需要深入理解云效的数据模型和工作流

### 风险缓解

#### 1. 技术风险
- **MCP协议变化**：密切关注MCP协议更新，制定适配计划
- **云效API限制**：设计合理的调用策略和错误处理

#### 2. 业务风险
- **用户采用风险**：保持配置简单，提供清晰的文档
- **维护成本风险**：设计模块化架构，便于维护和更新

## Implementation Approach

### 第一阶段：并行脚本创建（1-2周）
1. 创建init-yunxiao.sh云效环境检测脚本
2. 建立MCP协议基础调用函数库
3. 实现.ccpm-config.yaml配置文件检测机制

### 第二阶段：核心脚本并行化（2-3周）
1. 创建epic-sync-yunxiao/目录及所有对应脚本
2. 创建issue-sync-yunxiao/目录及工作项操作脚本
3. 实现fetch-yunxiao-workitems.sh等核心功能脚本

### 第三阶段：命令路由集成（1周）
1. 修改现有命令定义，增加平台检测和路由逻辑
2. 确保云效脚本与GitHub脚本接口一致性
3. 实现错误处理和用户提示

### 第四阶段：测试和文档（1周）
1. 测试GitHub脚本零影响（最小改动验证）
2. 云效环境完整功能测试
3. 更新用户文档和配置示例